(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c333f79"],{"2f21":function(t,e,n){"use strict";var i=n("79e5");t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},3530:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12",md:"4"}},[n("material-card",{staticClass:"v-card-profile",attrs:{loading:t.loadingCompanies,color:"primary"},scopedSlots:t._u([{key:"header",fn:function(){return[n("div",{staticClass:"pa-3"},[n("h4",{staticClass:"title font-weight-light"},[t._v("\n              Companies\n            ")])]),n("v-spacer"),n("v-btn",{staticClass:"mr-3",attrs:{color:"secondary"},on:{click:t.onCompanySelect}},[n("v-icon",{staticClass:"pr-3"},[t._v("\n              mdi-plus\n            ")]),t._v("Add Company\n          ")],1)]},proxy:!0}])},[t.loadingCompanies?n("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}}):n("profile-list",{attrs:{items:t.companies},on:{select:t.selectCompany}})],1)],1),n("v-col",{attrs:{cols:"12",md:"8"}},[t.selectedCompany?n("material-card",{staticClass:"v-card-profile",attrs:{color:"primary"},scopedSlots:t._u([{key:"header",fn:function(){return[n("div",{staticClass:"pa-3"},[n("h4",{staticClass:"title font-weight-light"},[t._v("\n              "+t._s(t.selectedCompany.name)+"\n            ")])]),n("v-spacer"),n("v-menu",{attrs:{bottom:"",left:"","offset-y":"",transition:"slide-y-transition"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.attrs,r=e.on;return[n("v-btn",t._g(t._b({staticClass:"toolbar-items",attrs:{icon:"",to:t.user?null:"/login?redirect="+t.$route.path}},"v-btn",i,!1),r),[n("v-icon",{attrs:{color:"secondary"}},[t._v("\n                  mdi-dots-vertical\n                ")])],1)]}}],null,!1,316168284)},[n("v-card",[n("v-list",{attrs:{dense:""}},[n("v-list-item",{on:{click:function(){return t.onCompanySelect(t.selectedCompany)}}},[n("v-list-item-title",[t._v("\n                    Edit Company\n                  ")])],1),n("v-list-item",{on:{click:t.onUserSelect}},[n("v-list-item-title",[t._v("\n                    Add User\n                  ")])],1),n("v-list-item",{on:{click:t.onSiteSelect}},[n("v-list-item-title",[t._v("\n                    Add Site\n                  ")])],1)],1)],1)],1)]},proxy:!0}],null,!1,2900726562)},[n("v-row",[n("v-col",{attrs:{cols:"12",md:"6"}},[n("h6",{staticClass:"overline"},[t._v("\n              Users\n            ")]),t.loadingUsers?n("v-progress-circular",{attrs:{size:50,color:"primary",indeterminate:""}}):n("profile-list",{attrs:{items:t.users},on:{edit:t.onUserSelect,delete:t.onUserDelete}})],1),n("v-col",{attrs:{cols:"12",md:"6"}},[n("h6",{staticClass:"overline"},[t._v("\n              Sites\n            ")]),n("profile-list",{attrs:{items:t.getSites()},on:{edit:t.onSiteSelect,delete:t.onSiteDelete}})],1)],1)],1):t._e()],1)],1),n("form-dialog",{ref:"dialog",attrs:{title:t.currentTitle,schema:t.currentSchema,item:t.currentItem},on:{submit:t.currentSubmit}}),n("yes-no-dialog",{ref:"yesno",on:{yes:t.currentDelete}})],1)},r=[],s=(n("8e6e"),n("456d"),n("6c7b"),n("28a5"),n("55dd"),n("ac6a"),n("a745")),o=n.n(s),a=n("db2a");function c(t){if(o()(t))return Object(a["a"])(t)}var l=n("774e"),u=n.n(l),d=n("c8bb"),m=n.n(d),p=n("67bb"),f=n.n(p);function h(t){if("undefined"!==typeof f.a&&m()(Object(t)))return u()(t)}var v=n("e630");function y(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(t){return c(t)||h(t)||Object(v["a"])(t)||y()}n("7f7f");var g=n("bd86"),C=n("cfc7"),S=n("283a"),I=n("c5f5"),_=n("c1df"),w=n.n(_);function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){Object(g["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={components:{FormDialog:C["a"],YesNoDialog:S["a"],ProfileList:I["a"]},data:function(){return{loadingCompanies:!1,loadingUsers:!1,currentTitle:"",currentSchema:{},currentSubmit:function(){},currentDelete:function(){},currentItem:{},companySchema:{name:{type:"text",label:"Name"}},userSchema:{name:{type:"text",label:"Name"},email:{type:"email",label:"Email"},password:{type:"password",appendIcon:"mdi-eye",label:"Password"},role:{type:"select",label:"Role",items:["Default","Editor","Admin"]}},siteSchema:{name:{type:"text",label:"Name"},domain:{type:"text",label:"Domain"}},companies:[],users:[],selectedCompany:null,user:O({},this.$store.state.user)}},computed:{company:function(){return this.$store.state.company},sites:function(){return this.$store.state.sites}},created:function(){this.selectedCompany=this.company,this.getCompanies(),this.getUsers()},methods:{moment:w.a,selectCompany:function(t){this.selectedCompany=t,this.getUsers()},onCompanySelect:function(t){this.currentSchema=this.companySchema,this.currentSubmit=this.updateCompany,t&&t.companyId?(this.currentItem=t,this.currentTitle="Update Company",this.currentMethod="put"):(this.currentItem={},this.currentTitle="Add Company",this.currentMethod="post"),this.$refs.dialog.open()},onSiteDelete:function(t){var e=this;this.currentDelete=function(n){return e.deleteSite(t,n)},this.$refs.yesno.open("Delete ".concat(t.name),"Are you sure you want to delete ".concat(t.name," from ").concat(this.selectedCompany.name,"?"))},onSiteSelect:function(t){this.currentSchema=this.siteSchema,this.currentSubmit=this.updateSite,t&&t.siteId?(this.currentItem=t,this.currentTitle="Update Site",this.currentMethod="put"):(this.currentItem={},this.currentTitle="Add Site",this.currentMethod="post"),this.$refs.dialog.open()},onUserDelete:function(t){var e=this;this.currentDelete=function(n){return e.deleteUser(t,n)},this.$refs.yesno.open("Remove ".concat(t.name),"Are you sure you want to remove ".concat(t.name," from ").concat(this.selectedCompany.name,"?"))},onUserSelect:function(t){this.currentSchema=this.userSchema,this.currentSubmit=this.updateUser,t&&t.userId?(this.currentItem=t,this.currentTitle="Update User",this.currentMethod="put"):(this.currentItem={password:this.randPassword(5,3,2,1)},this.currentTitle="Add User",this.currentMethod="post"),this.$refs.dialog.open()},updateUser:function(t){var e=this,n=t.item;n.companyId||(n.companyId=this.selectedCompany.companyId),this.api[this.currentMethod]("user",n).then((function(n){e.getUsers(),e.user.userId===n.data.userId&&(e.$store.commit("setUser",n.data),localStorage.setItem("claim",JSON.stringify(n.data))),t.done()}),(function(n){e.error=n,t.done()}))},updateCompany:function(t){var e=this,n=t.item;this.api[this.currentMethod]("company",n).then((function(n){e.getCompanies(),e.company.companyId===n.data.companyId&&e.$store.commit("setCompany",n.data),t.done()}),(function(n){e.error=n,t.done()}))},updateSite:function(t){var e=this,n=t.item;n.companyId||(n.companyId=this.selectedCompany.companyId),this.api[this.currentMethod]("sites",n).then((function(n){var i=[];"put"===e.currentMethod?i=e.sites.map((function(t){return t.siteId===n.data.siteId?n.data:t})):"post"===e.currentMethod&&(i=[n.data].concat(b(e.sites))),e.$store.commit("setSites",i),t.done()}),(function(n){e.error=n,t.done()}))},getSites:function(){var t=this,e=this.sites.filter((function(e){return e.companyId===t.selectedCompany.companyId}));return e.forEach((function(e){e.sub1=e.domain,e.sub2=t.moment(e.created).format("DD-MM-YY")})),e},getUsers:function(){var t=this;this.selectedCompany&&!this.loadingUsers&&(this.loadingUsers=!0,this.api.get("user/list/"+this.selectedCompany.companyId).then((function(e){var n=e.data;n.forEach((function(e){e.sub1=e.email,e.sub2=t.moment(e.created).format("DD-MM-YY")})),t.users=n,t.loadingUsers=!1}),(function(e){t.loadingUsers=!1,t.error=e})))},getCompanies:function(){var t=this;this.loadingCompanies||(this.loadingCompanies=!0,this.api.get("company/list").then((function(e){var n=e.data;n.forEach((function(e){e.sub1=t.moment(e.created).format("DD-MM-YY")})),t.companies=n,t.loadingCompanies=!1}),(function(e){t.loadingCompanies=!1,t.error=e})))},deleteUser:function(t,e){var n=this;this.api.delete("user/"+t.userId).then((function(t){n.getUsers(),e()}),(function(t){e(),n.error=t}))},deleteSite:function(t,e){var n=this;this.api.delete("sites/"+t.siteId).then((function(i){var r=n.sites.filter((function(e){return e.siteId!==t.siteId}));n.$store.commit("setSites",r),e()}),(function(t){e(),n.error=t}))},randPassword:function(t,e,n,i){var r=["abcdefghijklmnopqrstuvwxyz","0123456789","ABCDEFGHIJKLMNOPQRSTUVWXYZ","@#!?"];return[t,e,n,i].map((function(t,e){return Array(t).fill(r[e]).map((function(t){return t[Math.floor(Math.random()*t.length)]})).join("")})).concat().join("").split("").sort((function(){return.5-Math.random()})).join("")}}},j=D,M=n("2877"),V=n("6544"),$=n.n(V),P=n("8336"),k=n("b0af"),A=n("62ad"),E=n("a523"),T=n("132d"),x=n("8860"),L=n("da13"),Y=n("5d23"),N=n("e449"),J=n("490a"),R=n("0fd9"),z=n("2fa4"),B=Object(M["a"])(j,i,r,!1,null,null,null);e["default"]=B.exports;$()(B,{VBtn:P["a"],VCard:k["a"],VCol:A["a"],VContainer:E["a"],VIcon:T["a"],VList:x["a"],VListItem:L["a"],VListItemTitle:Y["c"],VMenu:N["a"],VProgressCircular:J["a"],VRow:R["a"],VSpacer:z["a"]})},"36bd":function(t,e,n){"use strict";var i=n("4bf8"),r=n("77f1"),s=n("9def");t.exports=function(t){var e=i(this),n=s(e.length),o=arguments.length,a=r(o>1?arguments[1]:void 0,n),c=o>2?arguments[2]:void 0,l=void 0===c?n:r(c,n);while(l>a)e[a++]=t;return e}},"55dd":function(t,e,n){"use strict";var i=n("5ca1"),r=n("d8e8"),s=n("4bf8"),o=n("79e5"),a=[].sort,c=[1,2,3];i(i.P+i.F*(o((function(){c.sort(void 0)}))||!o((function(){c.sort(null)}))||!n("2f21")(a)),"Array",{sort:function(t){return void 0===t?a.call(s(this)):a.call(s(this),r(t))}})},"6c7b":function(t,e,n){var i=n("5ca1");i(i.P,"Array",{fill:n("36bd")}),n("9c6c")("fill")},c5f5:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-list",[t._l(t.items,(function(e,i){return[n("v-list-item",t._g({key:i},t.$listeners.select?{click:function(){return t.$emit("select",e)}}:{}),[n("avatar",{attrs:{image:e.image,name:e.image?"":e.name,list:""}}),n("v-list-item-content",[n("v-list-item-title",[t._v("\n          "+t._s(e.name)+"\n        ")]),e.sub1||e.sub2?n("v-list-item-subtitle",[t._v("\n          "+t._s(e.sub1)),n("br"),t._v(t._s(e.sub2)+"\n        ")]):t._e()],1),t.$listeners.edit?n("v-list-item-action",[n("v-btn",{attrs:{icon:""},on:{click:function(n){n.stopPropagation(),t.$emit("edit",e)}}},[n("v-icon",[t._v("mdi-pencil")])],1)],1):t._e(),t.$listeners.delete?n("v-list-item-action",[n("v-btn",{attrs:{icon:""},on:{click:function(n){n.stopPropagation(),t.$emit("delete",e)}}},[n("v-icon",[t._v("mdi-delete")])],1)],1):t._e()],1)]}))],2)},r=[],s={props:{items:{type:Array,default:function(){return[]}}}},o=s,a=n("2877"),c=n("6544"),l=n.n(c),u=n("8336"),d=n("132d"),m=n("8860"),p=n("da13"),f=n("1800"),h=n("5d23"),v=Object(a["a"])(o,i,r,!1,null,null,null);e["a"]=v.exports;l()(v,{VBtn:u["a"],VIcon:d["a"],VList:m["a"],VListItem:p["a"],VListItemAction:f["a"],VListItemContent:h["a"],VListItemSubtitle:h["b"],VListItemTitle:h["c"]})}}]);
//# sourceMappingURL=chunk-5c333f79.021fb232.js.map